{% extends "base.html" %}

{% block title %}ThÆ° viá»‡n{% endblock %}

{% block extra_css %}
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

.book-card:hover { transform: translateY(-4px); }
.hero-gradienthome { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }

/* âœ… Active filter button (cháº¯c cháº¯n khÃ´ng bá»‹ Tailwind purge) */
.filter-btn.is-active{
  background-image: linear-gradient(90deg, #3b82f6, #4f46e5);
  color: white !important;
  border-color: transparent !important;
}
{% endblock %}

{% block content %}
<div class="bg-gray-50" style="font-family:'Inter', sans-serif;">

  <!-- HERO -->
  <section id="home" class="relative text-white py-28 overflow-hidden">
    <div class="absolute inset-0 bg-gradient-to-br from-indigo-700 via-purple-700 to-pink-600 opacity-90"></div>
    <div class="absolute inset-0 bg-[radial-gradient(circle_at_top_left,rgba(255,255,255,0.2),transparent_70%)]"></div>

    <div class="relative max-w-7xl mx-auto px-6 text-center">
      <h2 class="text-5xl md:text-7xl font-extrabold mb-6 leading-tight">
        KhÃ¡m phÃ¡ tháº¿ giá»›i tri thá»©c
      </h2>
      <p class="text-lg md:text-2xl mb-10 text-indigo-100">
        HÆ¡n <span class="font-semibold text-white">50,000+</span> Ä‘áº§u sÃ¡ch vÃ  tÃ i liá»‡u sá»‘ Ä‘ang chá» báº¡n!
      </p>

      <!-- SEARCH + AUTOCOMPLETE -->
      <div class="max-w-2xl mx-auto relative">
        <div class="flex items-center bg-white/10 backdrop-blur-md rounded-full shadow-xl overflow-hidden ring-1 ring-white/20 transition hover:ring-white/40">
          <form action="{% url 'library:search' %}" method="GET" class="flex w-full">
            <input
              type="text"
              name="q"
              id="searchInput"
              placeholder="ğŸ” TÃ¬m kiáº¿m sÃ¡ch, tÃ¡c giáº£ hoáº·c chá»§ Ä‘á»..."
              class="flex-1 px-6 py-4 bg-transparent text-white placeholder-gray-200 focus:outline-none"
              autocomplete="off"
              required
            >
            <button
              type="submit"
              class="bg-white text-indigo-700 font-semibold px-8 py-3 rounded-full hover:bg-indigo-100 transition-all duration-300"
            >
              TÃ¬m kiáº¿m
            </button>
          </form>
        </div>

        <ul id="suggestions"
            class="absolute left-0 top-full bg-white text-gray-800 rounded-lg mt-2 shadow-lg hidden z-50 w-full border border-gray-200">
        </ul>
      </div>
    </div>

    <svg class="absolute bottom-0 left-0 w-full text-white opacity-10" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
      <path fill="currentColor" fill-opacity="1" d="M0,192L60,176C120,160,240,128,360,112C480,96,600,96,720,122.7C840,149,960,203,1080,224C1200,245,1320,235,1380,229.3L1440,224L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z"></path>
    </svg>
  </section>

  <!-- STATS -->
  <section class="relative py-20 bg-gradient-to-br from-indigo-50 via-white to-purple-50 overflow-hidden">
    <div class="absolute inset-0 bg-[radial-gradient(circle_at_top_left,rgba(99,102,241,0.15),transparent_70%)]"></div>

    <div class="relative max-w-7xl mx-auto px-6 sm:px-8">
      <h2 class="text-3xl md:text-4xl font-bold text-center text-gray-800 mb-12">
        Nhá»¯ng con sá»‘ áº¥n tÆ°á»£ng ğŸŒŸ
      </h2>

      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-8 text-center">
        <div class="p-8 bg-white/80 backdrop-blur-md rounded-2xl shadow-md hover:shadow-xl transition-all duration-300 hover:-translate-y-2">
          <div class="flex justify-center mb-4 text-indigo-600 text-5xl">ğŸ“š</div>
          <div class="text-4xl font-extrabold text-indigo-700 mb-2 counter" data-target="50000">50,000+</div>
          <div class="text-gray-600 font-medium">Äáº§u sÃ¡ch</div>
        </div>

        <div class="p-8 bg-white/80 backdrop-blur-md rounded-2xl shadow-md hover:shadow-xl transition-all duration-300 hover:-translate-y-2">
          <div class="flex justify-center mb-4 text-indigo-600 text-5xl">ğŸ‘¥</div>
          <div class="text-4xl font-extrabold text-indigo-700 mb-2 counter" data-target="15000">15,000+</div>
          <div class="text-gray-600 font-medium">ThÃ nh viÃªn</div>
        </div>

        <div class="p-8 bg-white/80 backdrop-blur-md rounded-2xl shadow-md hover:shadow-xl transition-all duration-300 hover:-translate-y-2">
          <div class="flex justify-center mb-4 text-indigo-600 text-5xl">ğŸŒ</div>
          <div class="text-4xl font-extrabold text-indigo-700 mb-2">24/7</div>
          <div class="text-gray-600 font-medium">Truy cáº­p online</div>
        </div>

        <div class="p-8 bg-white/80 backdrop-blur-md rounded-2xl shadow-md hover:shadow-xl transition-all duration-300 hover:-translate-y-2">
          <div class="flex justify-center mb-4 text-indigo-600 text-5xl">ğŸ‰</div>
          <div class="text-4xl font-extrabold text-indigo-700 mb-2 counter" data-target="100">100+</div>
          <div class="text-gray-600 font-medium">Sá»± kiá»‡n/nÄƒm</div>
        </div>
      </div>
    </div>
  </section>

  <!-- CATALOG -->
  <section id="catalog" class="py-20 bg-gradient-to-b from-gray-50 to-white relative overflow-hidden">
    <div class="max-w-7xl mx-auto px-6 lg:px-8">

      <div class="text-center mb-16">
        <h3 class="text-4xl font-extrabold text-gray-900 mb-4 tracking-tight">
          ğŸ“š Danh Má»¥c SÃ¡ch Ná»•i Báº­t
        </h3>
        <p class="text-gray-600 text-lg max-w-2xl mx-auto">
          KhÃ¡m phÃ¡ nhá»¯ng cuá»‘n sÃ¡ch Ä‘Æ°á»£c yÃªu thÃ­ch vÃ  Ä‘Ã¡nh giÃ¡ cao nháº¥t táº¡i thÆ° viá»‡n cá»§a chÃºng tÃ´i.
        </p>
      </div>

      <!-- FILTER BUTTONS -->
      <div class="mb-10 flex flex-col items-center">
        <h3 class="text-2xl font-bold text-gray-800 mb-6 flex items-center justify-center">
          <span class="w-9 h-9 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg flex items-center justify-center mr-3 text-white">ğŸ·ï¸</span>
          Lá»c Theo Thá»ƒ Loáº¡i
        </h3>

        <div class="flex flex-wrap justify-center gap-3">
          <button type="button" data-category="all" onclick="filterBooks('all')"
            class="filter-btn bg-white text-gray-700 px-6 py-3 rounded-xl font-semibold border border-gray-200 shadow-sm hover:bg-gradient-to-r hover:from-indigo-500 hover:to-purple-600 hover:text-white transition-all duration-300">
            âœ¨ Táº¥t Cáº£
          </button>

          <button type="button" data-category="cong-nghe" onclick="filterBooks('cong-nghe')"
            class="filter-btn bg-white text-gray-700 px-6 py-3 rounded-xl font-semibold border border-gray-200 shadow-sm hover:bg-gradient-to-r hover:from-indigo-500 hover:to-purple-600 hover:text-white transition-all duration-300">
            ğŸ’» CÃ´ng Nghá»‡
          </button>

          <button type="button" data-category="toan-hoc" onclick="filterBooks('toan-hoc')"
            class="filter-btn bg-white text-gray-700 px-6 py-3 rounded-xl font-semibold border border-gray-200 shadow-sm hover:bg-gradient-to-r hover:from-indigo-500 hover:to-purple-600 hover:text-white transition-all duration-300">
            ğŸ”¢ ToÃ¡n Há»c
          </button>

          <button type="button" data-category="ngoai-ngu" onclick="filterBooks('ngoai-ngu')"
            class="filter-btn bg-white text-gray-700 px-6 py-3 rounded-xl font-semibold border border-gray-200 shadow-sm hover:bg-gradient-to-r hover:from-indigo-500 hover:to-purple-600 hover:text-white transition-all duration-300">
            ğŸŒ Ngoáº¡i Ngá»¯
          </button>

          <button type="button" data-category="van-hoc" onclick="filterBooks('van-hoc')"
            class="filter-btn bg-white text-gray-700 px-6 py-3 rounded-xl font-semibold border border-gray-200 shadow-sm hover:bg-gradient-to-r hover:from-indigo-500 hover:to-purple-600 hover:text-white transition-all duration-300">
            ğŸ“– VÄƒn Há»c
          </button>

          <button type="button" data-category="khoa-hoc" onclick="filterBooks('khoa-hoc')"
            class="filter-btn bg-white text-gray-700 px-6 py-3 rounded-xl font-semibold border border-gray-200 shadow-sm hover:bg-gradient-to-r hover:from-indigo-500 hover:to-purple-600 hover:text-white transition-all duration-300">
            ğŸ”¬ Khoa Há»c
          </button>

          <button type="button" data-category="kinh-te" onclick="filterBooks('kinh-te')"
            class="filter-btn bg-white text-gray-700 px-6 py-3 rounded-xl font-semibold border border-gray-200 shadow-sm hover:bg-gradient-to-r hover:from-indigo-500 hover:to-purple-600 hover:text-white transition-all duration-300">
            ğŸ’° Kinh Táº¿
          </button>
        </div>
      </div>

      <!-- CATALOG WRAPPER -->
      <div id="catalog-wrapper">
        {% include "library/partials/_catalog.html" %}
      </div>

    </div>
  </section>

  <!-- TOP / NEW BOOKS -->
  <section class="max-w-7xl mx-auto py-10 px-6 space-y-16">
    <div>
      <h2 class="text-3xl font-extrabold text-gray-900 mb-6 flex items-center gap-2">
        â­ SÃ¡ch Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ cao nháº¥t
      </h2>

      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-6">
        {% for book in top_rated_books %}
        <div class="relative bg-gradient-to-tr from-white to-gray-100 shadow-lg rounded-2xl overflow-hidden transform hover:scale-105 transition-transform duration-300">
          <div class="p-5 flex flex-col justify-between h-full">
            <div>
              <h3 class="font-bold text-lg mb-2 text-gray-800 line-clamp-2">{{ book.title }}</h3>
              <p class="text-gray-600 text-sm mb-1">TÃ¡c giáº£: {{ book.author }}</p>
              <p class="text-gray-500 text-sm mb-2">NÄƒm: {{ book.year }}</p>
              <p class="text-yellow-500 font-semibold mt-2 text-sm flex items-center gap-1">
                <span>â­</span> {{ book.avg_rating|default:"0.0" }}
              </p>
            </div>

            <div class="mt-4 flex justify-center">
              <a href="{% url 'library:book_detail_view' book.book_id %}"
                 class="bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-4 py-2 rounded-xl font-semibold text-sm shadow-md hover:shadow-xl hover:scale-105 transition-all duration-300 ease-in-out">
                ğŸ“˜ Chi tiáº¿t
              </a>
            </div>
          </div>

          <div class="absolute top-0 right-0 bg-yellow-400 text-white px-3 py-1 text-xs font-semibold rounded-bl-xl">
            Hot
          </div>
        </div>
        {% endfor %}
      </div>
    </div>

    <div>
      <h2 class="text-3xl font-extrabold text-gray-900 mb-6 flex items-center gap-2">
        ğŸ†• SÃ¡ch má»›i xuáº¥t báº£n
      </h2>

      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-6">
        {% for book in newest_books %}
        <div class="relative bg-gradient-to-tr from-white to-blue-50 shadow-lg rounded-2xl overflow-hidden transform hover:scale-105 transition-transform duration-300">
          <div class="p-5 flex flex-col justify-between h-full">
            <div>
              <h3 class="font-bold text-lg mb-2 text-gray-800 line-clamp-2">{{ book.title }}</h3>
              <p class="text-gray-600 text-sm mb-1">TÃ¡c giáº£: {{ book.author }}</p>
              <p class="text-gray-500 text-sm mb-2">NÄƒm: {{ book.year }}</p>
              <p class="text-yellow-500 font-semibold mt-2 text-sm flex items-center gap-1">
                <span>â­</span> {{ book.avg_rating|default:"0.0" }}
              </p>
            </div>

            <div class="mt-4 flex justify-center">
              <a href="{% url 'library:book_detail_view' book.book_id %}"
                 class="bg-gradient-to-r from-blue-500 to-indigo-600 text-white px-4 py-2 rounded-xl font-semibold text-sm shadow-md hover:shadow-xl hover:scale-105 transition-all duration-300 ease-in-out">
                ğŸ“˜ Chi tiáº¿t
              </a>
            </div>
          </div>

          <div class="absolute top-0 right-0 bg-blue-500 text-white px-3 py-1 text-xs font-semibold rounded-bl-xl">
            New
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </section>

  <!-- SERVICES -->
  <section id="services" class="relative py-20 bg-gradient-to-b from-white to-gray-50 overflow-hidden">
    <div class="absolute top-0 left-1/2 transform -translate-x-1/2 w-[600px] h-[600px] bg-indigo-100 rounded-full blur-3xl opacity-30"></div>

    <div class="relative max-w-7xl mx-auto px-6 lg:px-8">
      <div class="text-center mb-16">
        <h3 class="text-4xl font-extrabold text-gray-900 mb-4 tracking-tight">
          ğŸŒŸ Dá»‹ch Vá»¥ ThÆ° Viá»‡n
        </h3>
        <p class="text-gray-600 max-w-2xl mx-auto text-lg">
          ChÃºng tÃ´i cung cáº¥p Ä‘a dáº¡ng dá»‹ch vá»¥ há»— trá»£ há»c táº­p vÃ  nghiÃªn cá»©u â€” nhanh chÃ³ng, hiá»‡n Ä‘áº¡i, tiá»‡n lá»£i.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
        <a href="{% url 'library:services' %}"
           class="group bg-white rounded-2xl shadow-md hover:shadow-2xl transform hover:-translate-y-2 transition-all duration-500 border border-gray-100 p-8 text-center">
          <div class="w-20 h-20 mx-auto mb-6 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full flex items-center justify-center shadow-md group-hover:scale-110 transition-transform duration-300">
            <span class="text-3xl text-white">ğŸ“–</span>
          </div>
          <h4 class="text-2xl font-semibold text-gray-900 mb-3 group-hover:text-indigo-600 transition-colors">
            MÆ°á»£n SÃ¡ch
          </h4>
          <p class="text-gray-600 leading-relaxed">
            MÆ°á»£n sÃ¡ch táº¡i chá»— hoáº·c mang vá» vá»›i thá»i háº¡n linh hoáº¡t vÃ  quy trÃ¬nh Ä‘Æ¡n giáº£n.
          </p>
        </a>

        <a href="{% url 'library:services' %}"
           class="group bg-white rounded-2xl shadow-md hover:shadow-2xl transform hover:-translate-y-2 transition-all duration-500 border border-gray-100 p-8 text-center">
          <div class="w-20 h-20 mx-auto mb-6 bg-gradient-to-r from-blue-500 to-teal-400 rounded-full flex items-center justify-center shadow-md group-hover:scale-110 transition-transform duration-300">
            <span class="text-3xl text-white">ğŸ’»</span>
          </div>
          <h4 class="text-2xl font-semibold text-gray-900 mb-3 group-hover:text-indigo-600 transition-colors">
            ThÆ° Viá»‡n Sá»‘
          </h4>
          <p class="text-gray-600 leading-relaxed">
            Truy cáº­p hÃ ng nghÃ¬n tÃ i liá»‡u sá»‘, e-book vÃ  bÃ i nghiÃªn cá»©u cháº¥t lÆ°á»£ng cao, má»i lÃºc má»i nÆ¡i.
          </p>
        </a>

        <a href="{% url 'library:services' %}"
           class="group bg-white rounded-2xl shadow-md hover:shadow-2xl transform hover:-translate-y-2 transition-all duration-500 border border-gray-100 p-8 text-center">
          <div class="w-20 h-20 mx-auto mb-6 bg-gradient-to-r from-pink-500 to-rose-500 rounded-full flex items-center justify-center shadow-md group-hover:scale-110 transition-transform duration-300">
            <span class="text-3xl text-white">ğŸ“</span>
          </div>
          <h4 class="text-2xl font-semibold text-gray-900 mb-3 group-hover:text-indigo-600 transition-colors">
            Há»— Trá»£ NghiÃªn Cá»©u
          </h4>
          <p class="text-gray-600 leading-relaxed">
            ÄÆ°á»£c tÆ° váº¥n vÃ  hÆ°á»›ng dáº«n nghiÃªn cá»©u bá»Ÿi cÃ¡c chuyÃªn gia vÃ  giáº£ng viÃªn nhiá»u kinh nghiá»‡m.
          </p>
        </a>
      </div>
    </div>
  </section>

  <!-- CONTACT -->
  <section id="contact" class="py-16 bg-gray-900 text-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
        <div>
          <h3 class="text-3xl font-bold mb-6">LiÃªn há»‡ vá»›i chÃºng tÃ´i</h3>
          <div class="space-y-4">
            <div class="flex items-center space-x-3"><span class="text-xl">ğŸ“</span><span>ThÃºy Lai, PhÃº Kim, Tháº¡ch Tháº¥t, HÃ  Ná»™i</span></div>
            <div class="flex items-center space-x-3"><span class="text-xl">ğŸ“</span><span>0396984248</span></div>
            <div class="flex items-center space-x-3"><span class="text-xl">âœ‰ï¸</span><span>ntson10052005@st.phenikaa-uni.edu.vn</span></div>
            <div class="flex items-center space-x-3"><span class="text-xl">ğŸ•’</span><span>Thá»© 2 - Chá»§ nháº­t: 7:00 - 22:00</span></div>
          </div>
        </div>

        <div class="bg-gray-800 p-8 rounded-xl">
          <h4 class="text-xl font-semibold mb-4">Gá»­i tin nháº¯n</h4>
          <form class="space-y-4">
            <input type="text" placeholder="Há» vÃ  tÃªn"
                   class="w-full px-4 py-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
            <input type="email" placeholder="Email"
                   class="w-full px-4 py-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
            <textarea placeholder="Tin nháº¯n" rows="4"
                      class="w-full px-4 py-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
            <button type="submit"
                    class="w-full bg-indigo-600 text-white py-3 rounded-lg hover:bg-indigo-700 transition-colors">
              Gá»­i tin nháº¯n
            </button>
          </form>
        </div>
      </div>
    </div>
  </section>

</div>

<!-- ===================== JS (CHá»ˆ 1 Bá»˜, KHÃ”NG TRÃ™NG) ===================== -->
<script>
/* ===== Autocomplete ===== */
const searchInput = document.getElementById("searchInput");
const suggestionBox = document.getElementById("suggestions");

if (searchInput && suggestionBox) {
  searchInput.addEventListener("input", async () => {
    const query = searchInput.value.trim();
    if (!query) {
      suggestionBox.classList.add("hidden");
      return;
    }
    try {
      const response = await fetch(`/library/autocomplete/?q=${encodeURIComponent(query)}`);
      const data = await response.json();

      suggestionBox.innerHTML = "";

      if (data.results && data.results.length > 0) {
        data.results.forEach(item => {
          const li = document.createElement("li");
          li.className = "px-4 py-2 hover:bg-indigo-50 cursor-pointer text-gray-700";
          li.textContent = `${item.title || item.author || item.category}`;
          li.addEventListener("click", () => {
            searchInput.value = li.textContent;
            suggestionBox.classList.add("hidden");
          });
          suggestionBox.appendChild(li);
        });
        suggestionBox.classList.remove("hidden");
      } else {
        suggestionBox.classList.add("hidden");
      }
    } catch (error) {
      console.error("Autocomplete error:", error);
    }
  });

  document.addEventListener("click", (e) => {
    if (!suggestionBox.contains(e.target) && e.target !== searchInput) {
      suggestionBox.classList.add("hidden");
    }
  });
}

/* ===== Counter ===== */
const counters = document.querySelectorAll(".counter");
const options = { threshold: 0.6 };
const observer = new IntersectionObserver(entries => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      const counter = entry.target;
      const target = +counter.getAttribute("data-target");
      let count = 0;

      const update = () => {
        count += target / 60;
        if (count < target) {
          counter.textContent = Math.floor(count).toLocaleString() + "+";
          requestAnimationFrame(update);
        } else {
          counter.textContent = target.toLocaleString() + "+";
        }
      };
      update();
      observer.unobserve(counter);
    }
  });
}, options);

counters.forEach(c => observer.observe(c));

/* ===== Catalog AJAX + Active Button ===== */
let currentSort = "{{ sort_type|default:'rating' }}";
let currentCategory = "{{ category|default:'all' }}";

function setActiveCategory(category) {
  document.querySelectorAll(".filter-btn").forEach(btn => btn.classList.remove("is-active"));
  const active = document.querySelector(`.filter-btn[data-category="${category}"]`);
  if (active) active.classList.add("is-active");
}

async function loadCatalog({ page = 1, category = currentCategory, sort = currentSort } = {}) {
  const url = `?page=${page}&category=${encodeURIComponent(category)}&sort=${encodeURIComponent(sort)}`;

  const res = await fetch(url, { headers: { "X-Requested-With": "XMLHttpRequest" } });
  const html = await res.text();

  const wrapper = document.getElementById("catalog-wrapper");
  if (wrapper) wrapper.innerHTML = html;

  currentCategory = category;
  currentSort = sort;

  history.pushState({}, "", url);
  setActiveCategory(currentCategory);
}

function filterBooks(category) {
  currentCategory = category;
  setActiveCategory(currentCategory);
  loadCatalog({ page: 1, category: currentCategory });
}

// Click pagination trong catalog-wrapper
document.addEventListener("click", function(e) {
  const a = e.target.closest("#catalog-wrapper a");
  if (!a) return;

  const href = a.getAttribute("href");
  if (!href || !href.startsWith("?")) return;

  e.preventDefault();

  const params = new URLSearchParams(href.slice(1));
  loadCatalog({
    page: params.get("page") || 1,
    category: params.get("category") || currentCategory,
    sort: params.get("sort") || currentSort
  });

  // cuá»™n nháº¹ lÃªn catalog (tuá»³ báº¡n, khÃ´ng thÃ­ch thÃ¬ xoÃ¡)
  const catalog = document.getElementById("catalog");
  if (catalog) catalog.scrollIntoView({ behavior: "smooth", block: "start" });
});

// Load láº§n Ä‘áº§u theo URL
document.addEventListener("DOMContentLoaded", () => {
  const params = new URLSearchParams(location.search);
  currentCategory = params.get("category") || currentCategory;
  currentSort = params.get("sort") || currentSort;
  setActiveCategory(currentCategory);
});

// Back/Forward
window.addEventListener("popstate", () => {
  const params = new URLSearchParams(location.search);
  loadCatalog({
    page: params.get("page") || 1,
    category: params.get("category") || "all",
    sort: params.get("sort") || "rating"
  });
});
</script>

{% endblock %}
